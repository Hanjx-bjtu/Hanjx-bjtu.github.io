<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‡å­è®¡ç®— â€” å¸ƒæ´›èµ«çƒå¯è§†åŒ–ï¼ˆå•/å¤šé‡å­æ¯”ç‰¹ï¼‰</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjs@9.5.1/lib/browser/math.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸŒ é‡å­è®¡ç®—æ¦‚å¿µå¯è§†åŒ–å¹³å°</h1>
            <p class="subtitle">é‡å­æ¯”ç‰¹å¯è§†åŒ–</p>
        </header>
        
        <!-- é€‰é¡¹å¡åˆ‡æ¢ -->
        <div class="tab-container">
            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('single')">å•é‡å­æ¯”ç‰¹</button>
                <button class="tab-btn" onclick="switchTab('multi')">å¤šé‡å­æ¯”ç‰¹ç³»ç»Ÿ</button>
                <!-- <button class="tab-btn" onclick="switchTab('calculator')">æ¨¡æ‹Ÿé‡å­æ¯”ç‰¹è®¡ç®—å™¨</button> -->
                <button class="tab-btn" onclick="switchTab('calculator')">é‡å­ç®—æ³•æ¼”ç¤º</button>
            </div>
        </div>
        
        <!-- å•é‡å­æ¯”ç‰¹é¢æ¿ -->
        <div id="single-tab" class="tab-content active">
            <div class="main-content">
                <div class="left-panel">
                    <div id="blochSphere" class="bloch-container"></div>
                    <div class="controls">
                        <button id="resetView" class="btn">é‡ç½®è§†è§’</button>
                        <button id="toggleRotation" class="btn">æ—‹è½¬: å¼€</button>
                        <div class="info-box">
                            <div>å½“å‰æ€: <span id="quantumState">|0âŸ©</span></div>
                            <div>å¸ƒæ´›èµ«åæ ‡: <span id="coordinates">(0, 0, 1)</span></div>
                            <div>å…¨å±€ç›¸ä½ï¼ˆå‚è€ƒï¼‰: <span id="phase">0Â°</span></div>
                        </div>
                    </div>
                </div>
                
                <div class="right-panel">
                    <div class="quantum-controls">
                        <h2>å•é‡å­æ¯”ç‰¹æ§åˆ¶å™¨</h2>
                        
                        <div class="control-group">
                            <h3>å¸¸ç”¨åŸºæ€ / å åŠ æ€</h3>
                            <div class="state-buttons">
                                <button class="btn state-btn" data-state="0">|0âŸ©ï¼ˆé€»è¾‘ 0ï¼‰</button>
                                <button class="btn state-btn" data-state="1">|1âŸ©ï¼ˆé€»è¾‘ 1ï¼‰</button>
                                <button class="btn state-btn" data-state="plus">|+âŸ© = (|0âŸ©+|1âŸ©)/âˆš2</button>
                                <button class="btn state-btn" data-state="minus">|-âŸ© = (|0âŸ©-|1âŸ©)/âˆš2</button>
                                <button class="btn state-btn" data-state="iplus">|+iâŸ©</button>
                                <button class="btn state-btn" data-state="iminus">|-iâŸ©</button>
                            </div>
                        </div>
                        
                        <div class="control-group">
                            <h3>å¸ƒæ´›èµ«è§’åº¦ï¼ˆå‚æ•°åŒ–æ€ï¼‰</h3>
                            <div class="slider-container">
                                <label for="theta">æè§’ Î¸ (0Â°â€“180Â°): <span id="thetaValue">0Â°</span></label>
                                <input type="range" id="theta" min="0" max="180" value="0" step="1">
                            </div>
                            <div class="slider-container">
                                <label for="phi">æ–¹ä½è§’ Ï† (0Â°â€“360Â°): <span id="phiValue">0Â°</span></label>
                                <input type="range" id="phi" min="0" max="360" value="0" step="1">
                            </div>
                            <small>æ³¨ï¼šä»»ä½•å•æ¯”ç‰¹çº¯æ€å¯è¡¨ç¤ºä¸º |ÏˆâŸ© = cos(Î¸/2)|0âŸ© + e^{iÏ†} sin(Î¸/2)|1âŸ©</small>
                        </div>
                        
                        <div class="control-group">
                            <h3>å¸¸ç”¨é‡å­é—¨ï¼ˆå•æ¯”ç‰¹ï¼‰</h3>
                            <div class="gate-buttons">
                                <button class="btn gate-btn" data-gate="X">Xï¼ˆPauli-Xï¼‰</button>
                                <button class="btn gate-btn" data-gate="Y">Yï¼ˆPauli-Yï¼‰</button>
                                <button class="btn gate-btn" data-gate="Z">Zï¼ˆPauli-Zï¼‰</button>
                                <button class="btn gate-btn" data-gate="H">Hï¼ˆHadamardï¼‰</button>
                                <button class="btn gate-btn" data-gate="S">Sï¼ˆç›¸ä½é—¨ï¼‰</button>
                                <button class="btn gate-btn" data-gate="T">Tï¼ˆÏ€/8 é—¨ï¼‰</button>
                            </div>
                            <div id="gateInfoPanel" class="gate-info-panel">
                                <h4>é‡å­é—¨ä¿¡æ¯</h4>
                                <div id="gateDesc" class="gate-desc">ç‚¹å‡»é‡å­é—¨æŸ¥çœ‹åŠŸèƒ½æè¿°ã€çŸ©é˜µä¸è®¡ç®—è¿‡ç¨‹ã€‚</div>
                                <div id="gateMatrix" class="gate-matrix" style="font-family: monospace; white-space: pre; margin-top:8px;"></div>
                                <div id="gateComputation" class="gate-computation" style="font-family: monospace; white-space: pre-wrap; margin-top:8px; max-height:180px; overflow:auto;"></div>
                            </div>
                        </div>
                        
                        <div class="control-group">
                            <h3>è‡ªå®šä¹‰å¤æŒ¯å¹…ï¼ˆå½’ä¸€åŒ–ååº”ç”¨ï¼‰</h3>
                            <div class="input-group">
                                <label>Î± = å®éƒ¨ + iÂ·è™šéƒ¨</label>
                                <input type="number" id="alphaReal" step="0.1" value="1" title="Î± å®éƒ¨">
                                <input type="number" id="alphaImag" step="0.1" value="0" title="Î± è™šéƒ¨">
                            </div>
                            <div class="input-group">
                                <label>Î² = å®éƒ¨ + iÂ·è™šéƒ¨</label>
                                <input type="number" id="betaReal" step="0.1" value="0" title="Î² å®éƒ¨">
                                <input type="number" id="betaImag" step="0.1" value="0" title="Î² è™šéƒ¨">
                            </div>
                            <button id="applyCustom" class="btn">åº”ç”¨è‡ªå®šä¹‰æ€ï¼ˆå¹¶å½’ä¸€åŒ–ï¼‰</button>
                            <small>æ³¨æ„ï¼šè¾“å…¥çš„ Î±, Î² å°†åœ¨åº”ç”¨å‰æŒ‰ |Î±|^2+|Î²|^2 = 1 å½’ä¸€åŒ–</small>
                        </div>
                        
                        <div class="quantum-info">
                            <h3>å½“å‰é‡å­æ€ä¿¡æ¯ï¼ˆå•æ¯”ç‰¹ï¼‰</h3>
                            <div class="info-content">
                                <div>æ€çŸ¢é‡: |ÏˆâŸ© = <span id="stateVector">1Â·|0âŸ© + 0Â·|1âŸ©</span></div>
                                <div>å¯†åº¦çŸ©é˜µ Ï: <span id="densityMatrix">[[1, 0], [0, 0]]</span></div>
                                <div>å¸ƒæ´›èµ«å‘é‡: <span id="blochVector">(0, 0, 1)</span></div>
                                <div>æµ‹é‡æ¦‚ç‡: P(|0âŸ©)=<span id="prob0">100%</span>, P(|1âŸ©)=<span id="prob1">0%</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- å¤šé‡å­æ¯”ç‰¹é¢æ¿ -->
        <div id="multi-tab" class="tab-content">
            <div class="main-content">
                <div class="left-panel">
                    <div id="multiQubitSphere" class="bloch-container"></div>
                    <div class="controls">
                        <button id="multiResetView" class="btn">é‡ç½®è§†è§’</button>
                        <button id="multiToggleRotation" class="btn">æ—‹è½¬: å¼€</button>
                        <div class="info-box">
                            <div>é‡å­æ¯”ç‰¹æ•°: <span id="qubitCountDisplay">2 ä¸ª</span></div>
                            <div>ç³»ç»Ÿæ€ï¼ˆå¼ é‡ç§¯è¡¨ç¤ºï¼‰: <span id="multiQubitState">|0âŸ© âŠ— |0âŸ©</span></div>
                            <!-- <div><span id="entanglementInfo">çº ç¼ åº¦ï¼ˆç®€è¦ï¼‰ï¼š0.000</span></div> -->
                        </div>
                    </div>
                </div>
                
                <div class="right-panel">
                    <div class="quantum-controls">
                        <h2>å¤šé‡å­æ¯”ç‰¹æ§åˆ¶å™¨</h2>
                        
                        <div class="control-group">
                            <h3>ç³»ç»Ÿé…ç½®</h3>
                            <div class="slider-container">
                                <select id="qubitCount" class="btn" style="width: 100%; padding: 10px;">
                                    <option value="2" selected>2 ä¸ªé‡å­æ¯”ç‰¹</option>
                                    <option value="3">3 ä¸ªé‡å­æ¯”ç‰¹</option>
                                    <option value="4">4 ä¸ªé‡å­æ¯”ç‰¹</option>
                                    <option value="5">5 ä¸ªé‡å­æ¯”ç‰¹</option>
                                </select>
                                <small>æ³¨ï¼šå¸Œå°”ä¼¯ç‰¹ç©ºé—´ç»´åº¦ä¸º 2^nï¼ˆn ä¸ºæ¯”ç‰¹æ•°ï¼‰</small>
                            </div>
                        </div>
                        
                        <div class="control-group">
                            <h3>å¤šé‡å­æ¯”ç‰¹é—¨</h3>
                            <div class="gate-buttons">
                                <button class="btn multi-gate-btn" data-gate="CNOT">CNOTï¼ˆå—æ§éé—¨ï¼‰</button>
                                <button class="btn multi-gate-btn" data-gate="SWAP">SWAPï¼ˆäº¤æ¢é—¨ï¼‰</button>
                                <button class="btn multi-gate-btn" data-gate="CZ">CZï¼ˆå—æ§-Zï¼‰</button>
                                <button class="btn multi-gate-btn" data-gate="Bell">åˆ›å»º Bell æ€</button>
                                <button class="btn multi-gate-btn" data-gate="GHZ">åˆ›å»º GHZ æ€</button>
                            </div>
                            <div id="multiGateInfoPanel" class="gate-info-panel">
                                <h4>é—¨ä¿¡æ¯ï¼ˆå¤šæ¯”ç‰¹ï¼‰</h4>
                                <div id="multiGateDesc" class="gate-desc">ç‚¹å‡»å¤šæ¯”ç‰¹é—¨æŸ¥çœ‹åŠŸèƒ½æè¿°ä¸è®¡ç®—è¿‡ç¨‹ã€‚</div>
                                <div id="multiGateMatrix" class="gate-matrix" style="font-family: monospace; white-space: pre; margin-top:8px;"></div>
                                <div id="multiGateComputation" class="gate-computation" style="font-family: monospace; white-space: pre-wrap; margin-top:8px; max-height:180px; overflow:auto;"></div>
                            </div>
                        </div>
                        
                        <div class="control-group">
                            <h3>å•ä¸ªé‡å­æ¯”ç‰¹ï¼ˆå±€éƒ¨ï¼‰æ§åˆ¶</h3>
                            <div id="individualControls">
                                <!-- æ ¹æ®æ¯”ç‰¹æ•°åŠ¨æ€ç”Ÿæˆæ¯ä¸ªæ¯”ç‰¹çš„å±€éƒ¨å¸ƒæ´›èµ«è§’åº¦æ§åˆ¶ -->
                            </div>
                        </div>
                        
                        <!-- <div class="quantum-info">
                            <h3>ç³»ç»Ÿä¿¡æ¯ï¼ˆå¤šæ¯”ç‰¹ï¼‰</h3>
                            <div class="info-content">
                                <div>å¸Œå°”ä¼¯ç‰¹ç©ºé—´ç»´åº¦: <span id="stateDimension">2^nï¼ˆn ä¸ºæ¯”ç‰¹æ•°ï¼‰</span></div>
                                <div>æ€å‘é‡ï¼ˆå¼ é‡ç§¯å½¢å¼ï¼‰: <span id="globalStateVector">è®¡ç®—ä¸­...</span></div>
                                <div>çº ç¼ æµ‹åº¦ï¼ˆç¤ºä¾‹ï¼‰: <span id="entanglementMeasure">0.000</span></div>
                                <div>å„æ¯”ç‰¹å±€éƒ¨æ€:</div>
                                <div id="individualStates">|0âŸ©, |0âŸ©</div>
                            </div>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- é‡å­æ¯”ç‰¹è®¡ç®—å™¨é¢æ¿ -->
        <div id="calculator-tab" class="tab-content">
            <div class="main-content">
                <div class="left-panel">
                    <div style="padding: 20px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                        <h3>é‡å­æ€æ¼”åŒ–è¿‡ç¨‹</h3>
                        <div id="evolutionSteps" style="overflow-y: auto; max-height: 500px; padding: 10px;">
                            <div style="color: #888;">æ‰§è¡Œé—¨åºåˆ—åæ˜¾ç¤ºæ¼”åŒ–è¿‡ç¨‹...</div>
                        </div>
                    </div>
                    <div style="padding: 20px; background: rgba(255,255,255,0.05); border-radius: 10px; margin-top: 20px;">
                        <h3>æœ€ç»ˆé‡å­æ€ï¼ˆDiracè®°å·ï¼‰</h3>
                        <div id="finalDiracForm" style="font-family: monospace; font-size: 1rem; word-wrap: break-word; color: #64b5f6;">
                            |0âŸ©
                        </div>
                    </div>
                </div>
                
                <div class="right-panel">
                    <div class="quantum-controls">
                        <h2>é‡å­è®¡ç®—æ¼”ç¤ºå™¨</h2>
                        
                        <div class="control-group">
                            <h3>åˆå§‹é‡å­æ€</h3>
                            <div class="state-buttons" style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                                <button class="btn" onclick="setInitialState('0')" style="background: rgba(100, 181, 246, 0.3);">|0âŸ©</button>
                                <button class="btn" onclick="setInitialState('1')" style="background: rgba(100, 181, 246, 0.3);">|1âŸ©</button>
                                <button class="btn" onclick="setInitialState('plus')" style="background: rgba(100, 181, 246, 0.3);">|+âŸ©</button>
                                <button class="btn" onclick="setInitialState('minus')" style="background: rgba(100, 181, 246, 0.3);">|-âŸ©</button>
                            </div>
                            <div style="margin-top: 12px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                                <small>å½“å‰åˆæ€: <span id="initialStateDisplay">|0âŸ©</span></small>
                            </div>
                        </div>
                        
                        <div class="control-group">
                            <h3>ç³»ç»Ÿé…ç½®</h3>
                            <div>
                                <label for="calcQubitCount" style="display: block; margin-bottom: 8px;">é‡å­æ¯”ç‰¹æ•°ï¼š</label>
                                <select id="calcQubitCount" style="width: 100%; padding: 10px; border-radius: 6px; background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2);">
                                    <option value="1">1 ä¸ªæ¯”ç‰¹</option>
                                    <option value="2" selected>2 ä¸ªæ¯”ç‰¹</option>
                                    <option value="3">3 ä¸ªæ¯”ç‰¹</option>
                                    <option value="4">4 ä¸ªæ¯”ç‰¹</option>
                                    <option value="5">5 ä¸ªæ¯”ç‰¹</option>
                                </select>
                                <small>ï¼ˆä»…æ”¯æŒ 1-5 æ¯”ç‰¹ä»¥ä¿è¯å®æ—¶è®¡ç®—æ€§èƒ½ï¼‰</small>
                            </div>
                        </div>
                        
                        <div class="control-group">
                            <h3>é‡å­é—¨åºåˆ—ï¼ˆDiracè¡¨è¾¾å¼ï¼‰</h3>
                            <div>
                                <textarea id="gateSequence" placeholder="ç¤ºä¾‹ï¼š&#10;H0 CNOT01&#10;X1 Z0&#10;H0 H1 H2&#10;&#10;æ”¯æŒæ ¼å¼ï¼š&#10;X0, Y1, Z2 - Pauli é—¨&#10;H0, S1, T2 - å…¶ä»–å•æ¯”ç‰¹é—¨&#10;RX0(90), RY1(45) - æ—‹è½¬é—¨ï¼ˆåº¦ï¼‰&#10;CNOT01, CNOT10 - å—æ§é&#10;CZ01 - å—æ§-Z&#10;SWAP01 - äº¤æ¢&#10;" rows="6" style="width: 100%; border-radius: 6px; padding: 10px; background: rgba(0,0,0,0.2); color: #e1f5fe; border: 1px solid rgba(100, 181, 246, 0.5); font-family: monospace; font-size: 0.9rem;"></textarea>
                            </div>
                        </div>
                        
                        <div class="control-group">
                            <h3>è¿ç®—æ§åˆ¶</h3>
                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                <button id="executeSequence" class="btn" style="background: linear-gradient(135deg, #667eea, #764ba2); font-weight: bold; padding: 12px;">â–¶ æ‰§è¡Œé—¨åºåˆ—</button>
                                <button id="resetCalculator" class="btn" style="background: rgba(255, 107, 107, 0.3);">â†» é‡ç½®ï¼ˆæ¢å¤åˆæ€ï¼‰</button>
                                <button id="clearSequence" class="btn" style="background: rgba(100, 100, 100, 0.3);">âŒ« æ¸…é™¤è¾“å…¥</button>
                            </div>
                        </div>
                        
                        <div class="control-group">
                            <h3>æµ‹é‡æ¨¡æ‹Ÿ</h3>
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <input type="number" id="measurementTimes" value="1000" min="1" max="10000" style="flex: 1; padding: 8px; border-radius: 6px; background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2);">
                                <button id="performMeasurement" class="btn" style="flex: 1;">æµ‹é‡</button>
                            </div>
                            <div id="measurementResults" style="margin-top: 12px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 6px; font-family: monospace; font-size: 0.85rem;">
                                æŒ‰"æµ‹é‡"æŒ‰é’®æ˜¾ç¤ºç»Ÿè®¡ç»“æœ...
                            </div>
                        </div>

                        <div class="control-group">
                            <h3>é‡å­ç®—æ³•æ¼”ç¤º</h3>
                            <div style="display: grid; gap: 8px;">
                                <label for="algorithmSelect">é€‰æ‹©ç®—æ³•ï¼š</label>
                                <select id="algorithmSelect" style="padding:8px; border-radius:6px;">
                                    <option value="deutsch" title="
                                    Deutsch-Jozsaç”¨äºç¡®å®šä¸€ä¸ªç»™å®šçš„å¸ƒå°”å‡½æ•°æ˜¯å¸¸æ•°å‡½æ•°è¿˜æ˜¯å¹³è¡¡å‡½æ•°ã€‚è¯¥ç®—æ³•åˆ©ç”¨é‡å­å åŠ å’Œå¹²æ¶‰çš„ç‰¹æ€§ï¼Œèƒ½å¤Ÿåœ¨å•æ¬¡æŸ¥è¯¢ä¸­å®Œæˆè¿™ä¸€ä»»åŠ¡ï¼Œè€Œç»å…¸ç®—æ³•åœ¨æœ€åæƒ…å†µä¸‹éœ€è¦å¤šæ¬¡æŸ¥è¯¢ã€‚
                                    ">Deutsch-Jozsa</option>
                                    <option value="grover" title="
                                    Groveræ—¨åœ¨åœ¨æ— åºæ•°æ®åº“ä¸­é«˜æ•ˆåœ°æŸ¥æ‰¾ç‰¹å®šé¡¹ã€‚ä¸ç»å…¸æœç´¢ç®—æ³•éœ€è¦çº¿æ€§æ—¶é—´å¤æ‚åº¦ä¸åŒï¼ŒGroverç®—æ³•åˆ©ç”¨é‡å­å åŠ å’Œå¹²æ¶‰ï¼Œå®ç°äº†å¹³æ–¹æ ¹æ—¶é—´å¤æ‚åº¦çš„æœç´¢ï¼Œå¤§å¤§æé«˜äº†æœç´¢æ•ˆç‡ã€‚
                                    ">Grover æœç´¢</option>
                                    <option value="qft" title="
                                    é‡å­å‚…é‡Œå¶å˜æ¢ (QFT)ç”¨äºå°†é‡å­æ€ä»æ—¶åŸŸè½¬æ¢åˆ°é¢‘åŸŸã€‚å®ƒæ˜¯ç»å…¸å‚…é‡Œå¶å˜æ¢çš„é‡å­ç‰ˆæœ¬ï¼Œèƒ½å¤Ÿåœ¨å¤šé¡¹å¼æ—¶é—´å†…å®ç°å¯¹é‡å­æ€çš„é¢‘ç‡åˆ†æã€‚QFT åœ¨è®¸å¤šé‡å­ç®—æ³•ä¸­èµ·ç€å…³é”®ä½œç”¨ï¼Œå¦‚ Shor çš„è´¨å› æ•°åˆ†è§£ç®—æ³•ã€‚
                                    ">é‡å­å‚…é‡Œå¶å˜æ¢ (QFT)</option>
                                    <option value="qpe" title="
                                    é‡å­ç›¸ä½ä¼°è®¡ (QPE)ç”¨äºä¼°è®¡é‡å­æ€çš„ç›¸ä½ä¿¡æ¯ã€‚è¯¥ç®—æ³•é€šè¿‡æ„å»ºç‰¹å®šçš„é‡å­ç”µè·¯ï¼Œèƒ½å¤Ÿé«˜æ•ˆåœ°æå–é‡å­æ€çš„ç›¸ä½ï¼Œä»è€Œåœ¨è®¸å¤šé‡å­ç®—æ³•ä¸­å‘æŒ¥é‡è¦ä½œç”¨ï¼Œå¦‚ Shor çš„è´¨å› æ•°åˆ†è§£å’Œé‡å­æ¨¡æ‹Ÿã€‚
                                    ">é‡å­ç›¸ä½ä¼°è®¡ (QPE)</option>
                                </select>

                                <div id="algorithmParams" style="display: grid; gap:6px;">
                                    <!-- åŠ¨æ€å‚æ•°åŒºåŸŸï¼Œç”± quantumAlgorithms.js å¡«å…… -->
                                </div>

                                <button id="runAlgorithm" class="btn" style="background: linear-gradient(135deg, #43cea2, #185a9d);">è¿è¡Œç®—æ³•</button>
                            </div>
                        </div>
                        
                        <div class="quantum-info">
                            <h3>è®¡ç®—ç»“æœåˆ†æ</h3>
                            <div class="info-content">
                                <div>æ€å‘é‡ï¼ˆå¤æ•°å½¢å¼ï¼‰:</div>
                                <div id="resultAmplitudes" style="font-family: monospace; font-size: 0.9rem; margin: 10px 0; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 6px; max-height: 150px; overflow-y: auto;">
                                    è®¡ç®—åæ˜¾ç¤º...
                                </div>
                                <div style="margin-top: 12px;">
                                    <div>æµ‹é‡æ¦‚ç‡ï¼ˆè®¡ç®—åŸºï¼‰:</div>
                                    <div id="resultProbabilities" style="font-family: monospace; font-size: 0.85rem; margin: 10px 0; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 6px; max-height: 150px; overflow-y: auto;">
                                        è®¡ç®—åæ˜¾ç¤º...
                                    </div>
                                </div>
                                <div style="margin-top: 12px; padding: 10px; background: rgba(100, 181, 246, 0.1); border-left: 3px solid #64b5f6; border-radius: 6px;">
                                    <!-- <small>çº ç¼ ä¿¡æ¯: <span id="entanglementInfo" style="color: #64b5f6;">æ— çº ç¼ </span></small> -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>è¯´æ˜ï¼šå¸ƒæ´›èµ«çƒç”¨äºè¡¨ç¤ºå•é‡å­æ¯”ç‰¹çº¯æ€ï¼›å¤šé‡å­æ¯”ç‰¹ç³»ç»Ÿéœ€ä½¿ç”¨å¼ é‡ç§¯æè¿°ï¼Œçº ç¼ æ˜¯å¤šä½“é‡å­æ€çš„é‡è¦ç‰¹æ€§ã€‚</p>
            <p style="margin-top: 10px; font-size: 0.8rem; color: #888;">
                å•æ¯”ç‰¹ï¼šçƒé¢ä¸Šçš„ç‚¹ï¼ˆçº¯æ€ï¼‰ï¼›å¤šæ¯”ç‰¹ï¼š2^n ç»´å¸Œå°”ä¼¯ç‰¹ç©ºé—´ï¼Œå±€éƒ¨æµ‹é‡ä¸çº ç¼ éœ€åŒºåˆ†ã€‚
            </p>
        </footer>
    </div>
    
    <script src="blochSphere.js"></script>
    <script src="multiQubitVisualizer.js"></script>
    <script src="quantumEngine.js"></script>
    <script src="quantumAlgorithms.js"></script>
    <script>
        // å…¨å±€å˜é‡
        let singleQubitVisualizer = null;
        let multiQubitVisualizer = null;
        
        // ç”Ÿæˆå•ä¸ªé‡å­æ¯”ç‰¹æ§åˆ¶é¢æ¿
        function generateIndividualControls(qubitCount) {
            const container = document.getElementById('individualControls');
            container.innerHTML = ''; // æ¸…ç©ºç°æœ‰å†…å®¹
            
            for (let i = 0; i < qubitCount; i++) {
                const controlHTML = `
                    <div class="individual-qubit-control" style="margin-bottom: 15px; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                        <h4 style="margin-top: 0;">å±€éƒ¨é‡å­æ¯”ç‰¹ ${i}ï¼ˆå¸ƒæ´›èµ«è§’ï¼‰</h4>
                        <div class="slider-container">
                            <label for="theta${i}">æè§’ Î¸: <span id="thetaValue${i}">0Â°</span></label>
                            <input type="range" id="theta${i}" min="0" max="180" value="0" step="1" class="qubit-theta-slider">
                        </div>
                        <div class="slider-container">
                            <label for="phi${i}">æ–¹ä½è§’ Ï†: <span id="phiValue${i}">0Â°</span></label>
                            <input type="range" id="phi${i}" min="0" max="360" value="0" step="1" class="qubit-phi-slider">
                        </div>
                    </div>
                `;
                container.innerHTML += controlHTML;
            }
            
            // ä¸ºæ–°ç”Ÿæˆçš„æ»‘å—æ·»åŠ äº‹ä»¶ç›‘å¬
            attachQubitSliderListeners(qubitCount);
        }
        
        // ä¸ºå•ä¸ªé‡å­æ¯”ç‰¹æ»‘å—æ·»åŠ äº‹ä»¶ç›‘å¬
        function attachQubitSliderListeners(qubitCount) {
            for (let i = 0; i < qubitCount; i++) {
                const thetaSlider = document.getElementById(`theta${i}`);
                const phiSlider = document.getElementById(`phi${i}`);
                
                if (thetaSlider) {
                    thetaSlider.addEventListener('input', (e) => {
                        const theta = parseInt(e.target.value);
                        document.getElementById(`thetaValue${i}`).textContent = `${theta}Â°`;
                        // æ›´æ–°å¤šé‡å­æ¯”ç‰¹å¯è§†åŒ–ä¸­çš„è¯¥é‡å­æ¯”ç‰¹å±€éƒ¨æ€
                        if (multiQubitVisualizer && typeof multiQubitVisualizer.updateQubitState === 'function') {
                            multiQubitVisualizer.updateQubitState(i, theta, phiSlider ? phiSlider.value : 0);
                        }
                    });
                }
                
                if (phiSlider) {
                    phiSlider.addEventListener('input', (e) => {
                        const phi = parseInt(e.target.value);
                        document.getElementById(`phiValue${i}`).textContent = `${phi}Â°`;
                        // æ›´æ–°å¤šé‡å­æ¯”ç‰¹å¯è§†åŒ–ä¸­çš„è¯¥é‡å­æ¯”ç‰¹å±€éƒ¨æ€
                        if (multiQubitVisualizer && typeof multiQubitVisualizer.updateQubitState === 'function') {
                            multiQubitVisualizer.updateQubitState(i, thetaSlider ? thetaSlider.value : 0, phi);
                        }
                    });
                }
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            // åˆå§‹åŒ–å•é‡å­æ¯”ç‰¹å¯è§†åŒ–
            singleQubitVisualizer = new BlochSphereVisualizer('blochSphere');
            singleQubitVisualizer.updateQuantumState(0, 0);
            singleQubitVisualizer.updateSliderDisplay();
            
            // åˆå§‹åŒ–å¤šé‡å­æ¯”ç‰¹å¯è§†åŒ–ï¼ˆé»˜è®¤ 2 ä¸ªæ¯”ç‰¹ï¼‰
            multiQubitVisualizer = new MultiQubitVisualizer('multiQubitSphere', 2);
            
            // åˆå§‹åŒ–å•ä¸ªé‡å­æ¯”ç‰¹å±€éƒ¨æ§åˆ¶é¢æ¿
            generateIndividualControls(2);
            
            // è®¾ç½®å¤šé‡å­æ¯”ç‰¹æ§åˆ¶æŒ‰é’®
            document.getElementById('multiResetView').addEventListener('click', () => {
                if (multiQubitVisualizer && multiQubitVisualizer.controls) multiQubitVisualizer.controls.reset();
            });
            
            document.getElementById('multiToggleRotation').addEventListener('click', (e) => {
                if (!multiQubitVisualizer) return;
                multiQubitVisualizer.rotationEnabled = !multiQubitVisualizer.rotationEnabled;
                e.target.textContent = `æ—‹è½¬: ${multiQubitVisualizer.rotationEnabled ? 'å¼€' : 'å…³'}`;
            });
            
            // æ·»åŠ é‡å­æ¯”ç‰¹æ•°é‡å˜åŒ–ç›‘å¬ï¼ˆåŠ¨æ€æ›´æ–°ç•Œé¢ä¸å¯è§†åŒ–ï¼‰
            document.getElementById('qubitCount').addEventListener('change', (e) => {
                const qubitNum = parseInt(e.target.value);
                // æ›´æ–°æ˜¾ç¤ºï¼ˆæ›´ç¬¦åˆé‡å­æœ¯è¯­ï¼‰
                document.getElementById('qubitCountDisplay').textContent = `${qubitNum} ä¸ª`;
                // é‡æ–°åˆå§‹åŒ–å¤šé‡å­æ¯”ç‰¹å¯è§†åŒ–
                multiQubitVisualizer = new MultiQubitVisualizer('multiQubitSphere', qubitNum);
                // åŠ¨æ€ç”Ÿæˆå•ä¸ªé‡å­æ¯”ç‰¹å±€éƒ¨æ§åˆ¶é¢æ¿
                generateIndividualControls(qubitNum);
                // æ›´æ–°ç³»ç»Ÿä¿¡æ¯å ä½æ–‡æœ¬
                document.getElementById('stateDimension').textContent = `2^nï¼ˆn = ${qubitNum}ï¼‰`;
                document.getElementById('individualStates').textContent = Array(qubitNum).fill('|0âŸ©').join(', ');
            });
            
            // åˆå§‹åŒ–é€‰é¡¹å¡
            switchTab('single');
        });
        
        function switchTab(tabName) {
            // éšè—æ‰€æœ‰é€‰é¡¹å¡å†…å®¹
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰é€‰é¡¹å¡æŒ‰é’®çš„æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰å®šçš„é€‰é¡¹å¡å†…å®¹
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // æ¿€æ´»å¯¹åº”çš„é€‰é¡¹å¡æŒ‰é’®
            document.querySelector(`.tab-btn[onclick="switchTab('${tabName}')"]`).classList.add('active');
            
            // è°ƒæ•´å¯è§†åŒ–å¤§å°
            setTimeout(() => {
                if (tabName === 'single' && singleQubitVisualizer) {
                    singleQubitVisualizer.onWindowResize();
                } else if (tabName === 'multi' && multiQubitVisualizer) {
                    multiQubitVisualizer.onWindowResize();
                }
            }, 100);
        }
        
        // æ›´æ–°CSSä»¥æ”¯æŒé€‰é¡¹å¡
        const style = document.createElement('style');
        style.textContent = `
            .tab-container {
                margin-bottom: 20px;
            }
            
            .tabs {
                display: flex;
                background: rgba(255, 255, 255, 0.05);
                border-radius: 10px;
                padding: 5px;
                margin-bottom: 20px;
            }
            
            .tab-btn {
                flex: 1;
                padding: 12px 20px;
                background: transparent;
                color: #aaa;
                border: none;
                border-radius: 8px;
                cursor: pointer;
                font-size: 1rem;
                font-weight: 500;
                transition: all 0.3s ease;
            }
            
            .tab-btn.active {
                background: linear-gradient(135deg, #667eea, #764ba2);
                color: white;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            }
            
            .tab-btn:hover:not(.active) {
                background: rgba(255, 255, 255, 0.1);
            }
            
            .tab-content {
                display: none;
            }
            
            .tab-content.active {
                display: block;
                animation: fadeIn 0.5s ease;
            }
            
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
        `;
        document.head.appendChild(style);
    </script>
    <script>
        // é—¨ä¿¡æ¯ä¸å±•ç¤ºé€»è¾‘ï¼ˆå•/å¤šæ¯”ç‰¹é€šç”¨ï¼‰
        (function(){
            const gateMeta = {
                'X': { name: 'Pauli-X', desc: 'ç¿»è½¬åŸºæ€ |0âŸ©â†”|1âŸ©ï¼Œç±»ä¼¼ç»å…¸çš„ NOTã€‚' },
                'Y': { name: 'Pauli-Y', desc: 'Y é—¨ï¼šå¼•å…¥ç›¸ä½å¹¶ç¿»è½¬ï¼ŒçŸ©é˜µå«è™šæ•°ã€‚' },
                'Z': { name: 'Pauli-Z', desc: 'Z é—¨ï¼šåœ¨ |1âŸ© ä¸ŠåŠ ç›¸ä½ -1ï¼Œä¸æ”¹å˜æµ‹é‡æ¦‚ç‡ã€‚' },
                'H': { name: 'Hadamard', desc: 'å°†åŸºæ€æ˜ å°„ä¸ºå åŠ æ€ï¼ŒH|0âŸ©=|+âŸ©, H|1âŸ©=|âˆ’âŸ©ã€‚' },
                'S': { name: 'Sï¼ˆç›¸ä½ï¼‰', desc: 'åœ¨ |1âŸ© ä¸Šæ–½åŠ ç›¸ä½ iï¼ˆÏ€/2ï¼‰ã€‚' },
                'T': { name: 'Tï¼ˆÏ€/8ï¼‰', desc: 'åœ¨ |1âŸ© ä¸Šæ–½åŠ ç›¸ä½ e^{iÏ€/4}ï¼ˆÏ€/8 é—¨ï¼‰ã€‚' },
                'CNOT': { name: 'CNOTï¼ˆå—æ§éï¼‰', desc: 'è‹¥æ§åˆ¶æ¯”ç‰¹ä¸º |1âŸ©ï¼Œåˆ™ç¿»è½¬ç›®æ ‡æ¯”ç‰¹ã€‚é»˜è®¤æ§åˆ¶ 0ï¼Œç›®æ ‡ 1ã€‚' },
                'SWAP': { name: 'SWAPï¼ˆäº¤æ¢ï¼‰', desc: 'äº¤æ¢ä¸¤ä¸ªæ¯”ç‰¹çš„çŠ¶æ€ã€‚' },
                'CZ': { name: 'CZï¼ˆå—æ§-Zï¼‰', desc: 'è‹¥æ§åˆ¶ä¸ç›®æ ‡å‡ä¸º |1âŸ©ï¼Œåœ¨è¯¥åˆ†é‡åŠ ç›¸ä½ -1ã€‚' },
                'Bell': { name: 'åˆ›å»º Bell æ€', desc: 'ç”Ÿæˆä¸¤æ¯”ç‰¹çº ç¼ æ€ |Î¦+âŸ©=(|00âŸ©+|11âŸ©)/âˆš2ã€‚' },
                'GHZ': { name: 'åˆ›å»º GHZ æ€', desc: 'ç”Ÿæˆ GHZ æ€ (|00...0âŸ©+|11...1âŸ©)/âˆš2ã€‚' }
            };

            function formatMatrix(mat) {
                if (!mat) return '';
                try {
                    const size = mat.size ? mat.size() : null;
                    if (size && size.length === 2) {
                        const r = size[0];
                        const c = size[1];
                        let s = '';
                        for (let i=0;i<r;i++){
                            const row = [];
                            for (let j=0;j<c;j++){
                                const v = mat.get([i,j]);
                                const re = math.re(v), im = math.im(v);
                                if (Math.abs(im) < 1e-10) row.push(re.toFixed(3));
                                else if (Math.abs(re) < 1e-10) row.push(im.toFixed(3)+'i');
                                else row.push(re.toFixed(3)+ (im>=0?'+':'-') + Math.abs(im).toFixed(3)+'i');
                            }
                            s += '['+row.join(', ')+']\n';
                        }
                        return s;
                    }
                } catch(e){ return String(mat); }
                return String(mat);
            }

            function vecToArray(vec) {
                const size = vec.size();
                const r = size[0];
                const out = [];
                for (let i=0;i<r;i++){
                    const v = vec.get([i,0]);
                    out.push({ re: math.re(v), im: math.im(v) });
                }
                return out;
            }

            function formatAmplitudes(arr){
                return arr.map((c,i)=>{
                    const re = c.re, im = c.im;
                    if (Math.abs(im) < 1e-10) return `${re.toFixed(3)}|${i.toString(2).padStart(Math.log2(arr.length),'0')}âŸ©`;
                    return `${re.toFixed(3)}${im>=0?'+':''}${im.toFixed(3)}i|${i.toString(2).padStart(Math.log2(arr.length),'0')}âŸ©`;
                }).join(' + ');
            }

            // æ‰‹åŠ¨æä¾› 2-qubit çŸ©é˜µï¼ˆç”¨äºå±•ç¤ºï¼‰
            function cnot2(){
                return math.matrix([
                    [1,0,0,0],[0,1,0,0],[0,0,0,1],[0,0,1,0]
                ]).reshape([4,4]);
            }
            function swap2(){
                return math.matrix([
                    [1,0,0,0],[0,0,1,0],[0,1,0,0],[0,0,0,1]
                ]).reshape([4,4]);
            }
            function cz2(){
                return math.matrix([
                    [1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,-1]
                ]).reshape([4,4]);
            }

            function showSingleGateInfo(gate){
                const meta = gateMeta[gate] || {name:gate, desc: ''};
                document.getElementById('gateDesc').textContent = `${meta.name} â€” ${meta.desc}`;

                // çŸ©é˜µ
                const gateMatrix = (QuantumEngine && QuantumEngine.gates && QuantumEngine.gates[gate]) ? QuantumEngine.gates[gate] : null;
                let matStr = '';
                if (gateMatrix && typeof gateMatrix === 'object') {
                    // if it's a function (RX/RY/RZ) skip
                    if (typeof gateMatrix === 'function') matStr = '[parametric rotation gate]';
                    else matStr = formatMatrix(gateMatrix);
                }
                document.getElementById('gateMatrix').textContent = matStr;

                // è®¡ç®—è¿‡ç¨‹ï¼šä½¿ç”¨ singleQubitVisualizer å½“å‰ alpha/beta
                if (window.singleQubitVisualizer){
                    const vis = singleQubitVisualizer;
                    const state = math.matrix([[vis.alpha],[vis.beta]]);
                    let applied = null;
                    try {
                        const M = (gateMatrix && typeof gateMatrix === 'object') ? gateMatrix : null;
                        if (M) applied = math.multiply(M, state);
                        else applied = null;
                    } catch(e){ applied = null; }

                    const before = `åˆå§‹: ${vis.formatComplex(vis.alpha)}|0âŸ© + ${vis.formatComplex(vis.beta)}|1âŸ©`;
                    const after = applied ? `ä½œç”¨å: ${formatMatrix(applied)}` : 'ä½œç”¨å: ï¼ˆæ•°å€¼è®¡ç®—ä¸å¯ç”¨ï¼Œä¾‹å¦‚å‚æ•°åŒ–é—¨ï¼‰';
                    document.getElementById('gateComputation').textContent = before + '\n' + after;
                }
            }

            function showMultiGateInfo(gate){
                const meta = gateMeta[gate] || {name:gate, desc: ''};
                document.getElementById('multiGateDesc').textContent = `${meta.name} â€” ${meta.desc}`;

                const n = multiQubitVisualizer ? multiQubitVisualizer.numQubits : 2;
                const global = multiQubitVisualizer ? multiQubitVisualizer.globalState : null;
                const initArr = global ? vecToArray(global) : null;
                let token = '';
                let fullMatStr = '';

                if (gate === 'CNOT') token = `CNOT01`;
                else if (gate === 'SWAP') token = `SWAP01`;
                else if (gate === 'CZ') token = `CZ01`;
                else if (gate === 'Bell') token = `BELL`;
                else if (gate === 'GHZ') token = `GHZ`;

                // æ˜¾ç¤ºçŸ©é˜µï¼ˆä»…å¯¹äº 2 qubit æä¾›æ˜¾å¼çŸ©é˜µï¼‰
                if (n === 2) {
                    if (gate === 'CNOT') fullMatStr = formatMatrix(cnot2());
                    else if (gate === 'SWAP') fullMatStr = formatMatrix(swap2());
                    else if (gate === 'CZ') fullMatStr = formatMatrix(cz2());
                } else {
                    fullMatStr = (gate==='Bell' || gate==='GHZ') ? '[ç‰¹æ®Šæ€ç”Ÿæˆï¼Œä¸ä»¥çŸ©é˜µå±•ç¤º]' : '[ä»…åœ¨ 2 æ¯”ç‰¹æ—¶å±•ç¤ºçŸ©é˜µ]';
                }
                document.getElementById('multiGateMatrix').textContent = fullMatStr;

                // è®¡ç®—è¿‡ç¨‹ï¼šä½¿ç”¨ QuantumEngine.applySequence è®¡ç®—ç»“æœå¹¶å±•ç¤ºå‰åå¹…å€¼
                if (initArr && token) {
                    try {
                        const result = QuantumEngine.applySequence(token, initArr, n);
                        const before = `åˆå§‹ï¼ˆDiracï¼‰ï¼š ${QuantumEngine.toDirac(initArr, n)}`;
                        const after = `ä½œç”¨åï¼ˆDiracï¼‰ï¼š ${QuantumEngine.toDirac(result, n)}`;
                        document.getElementById('multiGateComputation').textContent = before + '\n' + `åº”ç”¨: ${token}` + '\n' + after;
                    } catch(e){
                        document.getElementById('multiGateComputation').textContent = 'è®¡ç®—å¤±è´¥ï¼š' + e.message;
                    }
                } else {
                    document.getElementById('multiGateComputation').textContent = 'æ— æ³•è·å–åˆå§‹æ€è¿›è¡Œè®¡ç®—ã€‚';
                }
            }

            // ç»‘å®šå•/å¤šé—¨æŒ‰é’®çš„å±•ç¤ºè¡Œä¸ºï¼ˆä¸æ›¿æ¢å·²æœ‰çš„åº”ç”¨è¡Œä¸ºï¼‰
            document.addEventListener('DOMContentLoaded', () => {
                document.querySelectorAll('.gate-btn').forEach(btn=>{
                    btn.addEventListener('click', (e)=>{
                        const g = e.currentTarget.dataset.gate;
                        try{ showSingleGateInfo(g); }catch(err){ console.error(err); }
                    });
                });

                document.querySelectorAll('.multi-gate-btn').forEach(btn=>{
                    btn.addEventListener('click', (e)=>{
                        const g = e.currentTarget.dataset.gate;
                        try{ showMultiGateInfo(g); }catch(err){ console.error(err); }
                    });
                });
            });
        })();
    </script>
</body>
</html>